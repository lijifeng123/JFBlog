---
title: 内存管理二
date: 2022-07-05 17:32:38
tags:
---

> 一、定时器的循环引入
>
> 二、copy、mutableCopy
>
> 三、创建大量autorelease对象时，最好自己创建一个@autoreleasepool {}
>
> 四、其他注意事项

<!--more-->

### 一、定时器的循环引入

我们以`NSTimer`举例，`CADisplayLink`遇到同样的问题，解决方案也一样。

#### 1.`NSTimer`的循环引入

使用`NSTimer`，写法通常如下：

```objectivec
#import "ViewController.h"
#import "ViewController1.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    
}

- (void)touchesBegan:(NSSet<UITouch *> *)touches withEvent:(UIEvent *)event {
    
    ViewController1 *vc = [[ViewController1 alloc] init];
    [self.navigationController pushViewController:vc animated:YES];
}

@end
```

```objectivec
#import "ViewController1.h"

@interface ViewController1 ()

@property (nonatomic, strong) NSTimer *timer;

@end

@implementation ViewController1

- (void)viewDidLoad {
    [super viewDidLoad];
    
    // 创建timer
    self.timer = [NSTimer scheduledTimerWithTimeInterval:1 target:self selector:@selector(test) userInfo:nil repeats:YES];
}

- (void)test {
    
    NSLog(@"11");
}

- (void)dealloc {
    
    NSLog(@"%s", __func__);
    
    // 退出界面时，使timer失效从而销毁
    [self.timer invalidate];
}

@end
```

